<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Jesse Brodrick" />

<meta name="date" content="2024-03-14" />

<title>Local Moran’s I Clustering Analysis</title>

<script src="site_libs/header-attrs-2.21/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<link href="site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="site_libs/datatables-binding-0.32/datatables.js"></script>
<link href="site_libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="site_libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="site_libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>
<link href="site_libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="site_libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; } /* Alert */
code span.an { color: #008000; } /* Annotation */
code span.at { } /* Attribute */
code span.bu { } /* BuiltIn */
code span.cf { color: #0000ff; } /* ControlFlow */
code span.ch { color: #008080; } /* Char */
code span.cn { } /* Constant */
code span.co { color: #008000; } /* Comment */
code span.cv { color: #008000; } /* CommentVar */
code span.do { color: #008000; } /* Documentation */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.im { } /* Import */
code span.in { color: #008000; } /* Information */
code span.kw { color: #0000ff; } /* Keyword */
code span.op { } /* Operator */
code span.ot { color: #ff4000; } /* Other */
code span.pp { color: #ff4000; } /* Preprocessor */
code span.sc { color: #008080; } /* SpecialChar */
code span.ss { color: #008080; } /* SpecialString */
code span.st { color: #008080; } /* String */
code span.va { } /* Variable */
code span.vs { color: #008080; } /* VerbatimString */
code span.wa { color: #008000; font-weight: bold; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="html-md-01.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Project Web Page: R for Earth-System Science</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Topics
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Intro.html">Project Overview: Introduction, Methods, Materials and Conclusion</a>
    </li>
    <li>
      <a href="TreeCoverGain.html">Forest Cover Gain Maps</a>
    </li>
    <li>
      <a href="TreeCoverLoss.html">Forest Cover Loss Maps</a>
    </li>
    <li>
      <a href="LMI.html">Local Moran's I</a>
    </li>
    <li>
      <a href="CarbonF.html">Carbon Emission and Tree Cover Regressions</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="know.html">Acknowledgements</a>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Local Moran’s I Clustering Analysis</h1>
<h4 class="author">Jesse Brodrick</h4>
<h4 class="date">2024-03-14</h4>

</div>


<div
id="year-tree-cover-gain-anlaysis-with-spatial-distribution-and-clustering"
class="section level2" number="0.1">
<h2><span class="header-section-number">0.1</span> 20 year Tree Cover
Gain Anlaysis with Spatial Distribution and Clustering</h2>
<div id="reading-in-libraries-and-dataset" class="section level3"
number="0.1.1">
<h3><span class="header-section-number">0.1.1</span> Reading in
libraries and dataset</h3>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
<pre><code>## ── Attaching core tidyverse packages ─── tidyverse 2.0.0 ──
## ✔ forcats   1.0.0     ✔ purrr     1.0.1
## ✔ lubridate 1.9.2     ✔ tibble    3.2.1
## ── Conflicts ───────────────────── tidyverse_conflicts() ──
## ✖ dplyr::filter() masks stats::filter()
## ✖ dplyr::lag()    masks stats::lag()
## ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span></code></pre></div>
<pre><code>## Linking to GEOS 3.10.2, GDAL 3.4.2, PROJ 8.2.1; sf_use_s2() is TRUE</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tigris)</span></code></pre></div>
<pre><code>## To enable caching of data, set `options(tigris_use_cache = TRUE)`
## in your R script or .Rprofile.</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(classInt)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(spdep)</span></code></pre></div>
<pre><code>## Loading required package: spData
## To access larger datasets in this package, install the spDataLarge package with:
## `install.packages(&#39;spDataLarge&#39;, repos=&#39;https://nowosad.github.io/drat/&#39;, type=&#39;source&#39;)`</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tmap)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DT)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">getwd</span>()</span></code></pre></div>
<pre><code>## [1] &quot;/Users/jessebrodrick/Desktop/490Pro/GEOG490&quot;</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;/Users/jessebrodrick/Desktop/490Pro/data/GlblFW/CTCL1.csv&quot;</span>)</span></code></pre></div>
<pre><code>## Rows: 25184 Columns: 30
## ── Column specification ───────────────────────────────────
## Delimiter: &quot;,&quot;
## chr  (3): country, subnational1, subnational2
## dbl (27): threshold, area_ha, extent_2000_ha, extent_2010_ha, gain_2000_2020_ha, tc_loss_ha_2001, tc_...
## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div id="basemap-and-projection" class="section level3" number="0.1.2">
<h3><span class="header-section-number">0.1.2</span> Basemap and
projection</h3>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Options to return tigris objects as sf objects</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">tigris_class =</span> <span class="st">&quot;sf&quot;</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">tigris_use_cache =</span> <span class="cn">TRUE</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Obtain state boundaries</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>states_sf <span class="ot">&lt;-</span> <span class="fu">states</span>(<span class="at">cb =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## Retrieving data for the year 2021</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Obtain county boundaries</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>counties_sf <span class="ot">&lt;-</span> <span class="fu">counties</span>(<span class="at">cb =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## Retrieving data for the year 2021</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for western states and their counties</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>western_states <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Washington&quot;</span>, <span class="st">&quot;Oregon&quot;</span>, <span class="st">&quot;California&quot;</span>, <span class="st">&quot;Idaho&quot;</span>, </span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&quot;Montana&quot;</span>, <span class="st">&quot;Nevada&quot;</span>)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter state and counties for western states sf</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>wus_states_sf <span class="ot">&lt;-</span> states_sf[states_sf<span class="sc">$</span>NAME <span class="sc">%in%</span> western_states, ]</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>wus_counties_sf <span class="ot">&lt;-</span> counties_sf[counties_sf<span class="sc">$</span>STATE_NAME <span class="sc">%in%</span> western_states, ]</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Projection</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>laea <span class="ot">=</span> <span class="fu">st_crs</span>(<span class="st">&quot;+proj=laea +lat_0=30 +lon_0=-100&quot;</span>) <span class="co"># Lambert Azimuthal Equal Area</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>wus_states_sf_pro <span class="ot">=</span> <span class="fu">st_transform</span>(wus_states_sf, laea)</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>wus_counties_sf_pro <span class="ot">=</span> <span class="fu">st_transform</span>(wus_counties_sf, laea)</span></code></pre></div>
</div>
<div
id="subset-and-merge-global-forest-watch-data-and-projected-us-census-boundaries"
class="section level3" number="0.1.3">
<h3><span class="header-section-number">0.1.3</span> Subset and merge
Global Forest Watch data and projected US Census boundaries</h3>
</div>
<div
id="global-forest-watch-provides-thresholds-or-amount-of-tree-canopy-coverage-density-of-30m-resolution-for-0-10-20-30-50-and-75-percent-for-20-years-of-forest-cover-gainloss-in-hecatares."
class="section level3" number="0.1.4">
<h3><span class="header-section-number">0.1.4</span> Global Forest watch
provides thresholds or amount of tree canopy coverage (density of 30m
resolution) for 0, 10, 20, 30, 50, and 75 percent for 20 years of forest
cover gain/loss in hecatares.</h3>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Subset data based on the western states with a canopy density threshold of 50</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>df_subset <span class="ot">&lt;-</span> df[df<span class="sc">$</span>subnational1 <span class="sc">%in%</span> western_states, ] <span class="sc">%&gt;%</span> </span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">filter</span>(threshold <span class="sc">==</span> <span class="dv">50</span>)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df_subset)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 30
##   country     subnational1 subnational2 threshold area_ha extent_2000_ha extent_2010_ha gain_2000_2020_ha
##   &lt;chr&gt;       &lt;chr&gt;        &lt;chr&gt;            &lt;dbl&gt;   &lt;dbl&gt;          &lt;dbl&gt;          &lt;dbl&gt;             &lt;dbl&gt;
## 1 United Sta… California   Alameda             50  193504          21034          27052              1613
## 2 United Sta… California   Alpine              50  191835          53981          40667               701
## 3 United Sta… California   Amador              50  156853          38417          49461              1061
## 4 United Sta… California   Butte               50  434521         163077         169724              4657
## 5 United Sta… California   Calaveras           50  268505          75162         101364              2315
## 6 United Sta… California   Colusa              50  301134          31108          29999              3335
## # ℹ 22 more variables: tc_loss_ha_2001 &lt;dbl&gt;, tc_loss_ha_2002 &lt;dbl&gt;, tc_loss_ha_2003 &lt;dbl&gt;,
## #   tc_loss_ha_2004 &lt;dbl&gt;, tc_loss_ha_2005 &lt;dbl&gt;, tc_loss_ha_2006 &lt;dbl&gt;, tc_loss_ha_2007 &lt;dbl&gt;,
## #   tc_loss_ha_2008 &lt;dbl&gt;, tc_loss_ha_2009 &lt;dbl&gt;, tc_loss_ha_2010 &lt;dbl&gt;, tc_loss_ha_2011 &lt;dbl&gt;,
## #   tc_loss_ha_2012 &lt;dbl&gt;, tc_loss_ha_2013 &lt;dbl&gt;, tc_loss_ha_2014 &lt;dbl&gt;, tc_loss_ha_2015 &lt;dbl&gt;,
## #   tc_loss_ha_2016 &lt;dbl&gt;, tc_loss_ha_2017 &lt;dbl&gt;, tc_loss_ha_2018 &lt;dbl&gt;, tc_loss_ha_2019 &lt;dbl&gt;,
## #   tc_loss_ha_2020 &lt;dbl&gt;, tc_loss_ha_2021 &lt;dbl&gt;, tc_loss_ha_2022 &lt;dbl&gt;</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Merging projected SF to GFW data frame</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>wus_gbl_merge <span class="ot">&lt;-</span> wus_counties_sf_pro <span class="sc">%&gt;%</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(df_subset, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;STATE_NAME&quot;</span> <span class="ot">=</span> <span class="st">&quot;subnational1&quot;</span>, <span class="st">&quot;NAME&quot;</span> <span class="ot">=</span> <span class="st">&quot;subnational2&quot;</span>))</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Replacing NA&#39;s with zero</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>wus_gbl_merge <span class="ot">&lt;-</span> wus_gbl_merge <span class="sc">%&gt;%</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gain_2000_2020_ha =</span> <span class="fu">replace_na</span>(gain_2000_2020_ha, <span class="dv">0</span>))</span></code></pre></div>
</div>
</div>
<div id="local-morans-i-for-tree-cover-gain" class="section level2"
number="0.2">
<h2><span class="header-section-number">0.2</span> Local Moran’s I for
Tree Cover Gain</h2>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>nb <span class="ot">&lt;-</span> <span class="fu">poly2nb</span>(wus_gbl_merge, <span class="at">queen=</span><span class="cn">TRUE</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>nb[<span class="dv">1</span>]</span></code></pre></div>
<pre><code>## [[1]]
## [1]  93 215 219 233</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>lw <span class="ot">&lt;-</span> <span class="fu">nb2listw</span>(nb, <span class="at">style=</span><span class="st">&quot;W&quot;</span>, <span class="at">zero.policy=</span><span class="cn">TRUE</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>lw<span class="sc">$</span>weights[<span class="dv">1</span>]</span></code></pre></div>
<pre><code>## [[1]]
## [1] 0.25 0.25 0.25 0.25</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>gain.lag <span class="ot">&lt;-</span> <span class="fu">lag.listw</span>(lw, wus_gbl_merge<span class="sc">$</span>gain_2000_2020_ha)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>gain.lag</span></code></pre></div>
<pre><code>##   [1]  1362.25000   557.50000 17690.71429  5993.28571  4033.50000  8559.66667  6979.66667  2405.75000
##   [9] 11740.33333  5901.66667  4429.76923  4004.60000   631.00000  3439.25000  7139.00000   550.00000
##  [17]   766.75000  5638.50000  6126.75000   458.40000  2578.66667   994.20000   407.20000  7146.20000
##  [25]  4660.50000  1021.55556  5114.50000  9828.87500  4129.66667  7213.14286    15.20000 14182.85714
##  [33]  6533.75000  3074.25000  2578.66667  1632.16667  3758.57143  8363.25000  6370.40000   261.20000
##  [41] 11853.50000  1434.60000   508.60000  1185.33333 14676.00000  2891.14286  2674.00000  5841.60000
##  [49]  3229.57143     7.75000 13032.66667     0.00000  1634.85714   960.66667  9806.00000  1569.00000
##  [57]  7236.25000  8238.62500  8190.16667  9330.16667  2178.83333  7768.66667  3294.66667 16350.25000
##  [65]  3849.62500  3660.00000   459.00000 11396.77778 11416.50000  8644.33333  1968.00000  7276.66667
##  [73]  5214.75000  2886.60000  1771.12500  2145.00000  2069.75000  4671.60000   134.00000  2367.00000
##  [81]  8020.14286  9033.33333  7059.25000  2246.75000  2075.83333  5578.00000  5367.75000  8959.00000
##  [89]   663.37500  7183.40000  8690.60000  4370.75000   948.40000  5860.85714 20402.83333  8877.22222
##  [97]  5348.50000  4762.66667  7538.66667  8928.50000  8713.25000  5324.83333  2752.12500  2467.66667
## [105] 17116.33333  2223.90000  1509.60000  6189.00000   791.25000 10288.60000    52.40000  6689.14286
## [113]  7184.50000  3752.00000 13851.00000  3987.50000 10801.20000  7761.25000  1132.60000  1568.20000
## [121]  3535.16667  3985.00000   566.66667  4997.00000 10082.00000 12253.66667   455.71429  4669.83333
## [129]   484.25000  4962.50000  6155.16667  3079.00000 22437.14286  8977.66667 11292.50000  4327.28571
## [137]  2993.20000   416.25000  3112.00000  3658.20000  2311.50000  3773.00000  1993.75000  8106.00000
## [145]  6784.00000  3119.11111  6577.33333 15570.00000   751.12500 12862.00000  2848.66667  7416.80000
## [153]  5981.60000 10898.16667 10044.25000 12327.25000  5116.00000   365.00000  8357.77778 24882.50000
## [161]  5184.57143  3901.37500   188.60000 11479.00000  2602.00000  3784.33333  3369.75000 10951.00000
## [169]  1760.44444 10743.71429  6547.00000  1192.42857  1608.80000 23313.00000   932.40000 10388.57143
## [177] 13481.80000  4738.85714  6803.55556    90.66667 10833.50000  4819.66667  3326.20000  5058.60000
## [185]  6844.75000  6837.80000  1440.00000    95.50000 20972.83333     9.25000  1068.50000  8530.57143
## [193]  2879.20000    12.00000   738.66667  6678.71429  2721.75000  4866.00000 14693.33333  6218.66667
## [201]  7684.50000  9731.40000  1141.00000  8868.50000   347.25000 27803.00000    13.00000  6728.50000
## [209]   676.20000  1624.00000   192.00000   772.20000  4955.28571 14655.50000  1050.85714  2582.50000
## [217]  6085.60000   317.00000  2274.40000  3820.25000  4897.66667  2636.14286  3890.25000  2697.83333
## [225]  7957.71429  2417.83333  7556.16667   606.66667  1513.25000   592.20000   195.00000  5716.60000
## [233]   671.40000  3421.00000  3288.50000  4896.40000    24.83333    11.50000  6673.71429  3539.20000
## [241]  2709.16667  6275.00000   729.50000  2157.00000   786.33333   509.42857 12777.80000  7667.33333
## [249]  1714.60000  2329.75000</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(gain.lag <span class="sc">~</span> wus_gbl_merge<span class="sc">$</span>gain_2000_2020_ha, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">asp=</span><span class="dv">1</span>)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>M1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(gain.lag <span class="sc">~</span> wus_gbl_merge<span class="sc">$</span>gain_2000_2020_ha)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(M1, <span class="at">col=</span><span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="LMI_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(M1)[<span class="dv">2</span>]</span></code></pre></div>
<pre><code>## wus_gbl_merge$gain_2000_2020_ha 
##                       0.4049434</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>I <span class="ot">&lt;-</span> <span class="fu">moran</span>(wus_gbl_merge<span class="sc">$</span>gain_2000_2020_ha, lw, <span class="fu">length</span>(nb), <span class="fu">Szero</span>(lw))[<span class="dv">1</span>]</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>I</span></code></pre></div>
<pre><code>## $I
## [1] 0.4047753</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">moran.test</span>(wus_gbl_merge<span class="sc">$</span>gain_2000_2020_ha,lw, <span class="at">alternative=</span><span class="st">&quot;greater&quot;</span>)</span></code></pre></div>
<pre><code>## 
##  Moran I test under randomisation
## 
## data:  wus_gbl_merge$gain_2000_2020_ha  
## weights: lw  n reduced by no-neighbour observations
##   
## 
## Moran I statistic standard deviate = 10.961, p-value &lt; 2.2e-16
## alternative hypothesis: greater
## sample estimates:
## Moran I statistic       Expectation          Variance 
##       0.403156236      -0.004032258       0.001380136</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="do">####There is less than a 6% likelihood that the observed pattern could be the result of random chance</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="co">#p-value of 2.2e-16 suggesting that there would be a an extremely low chance of being wrong in rejecting the null hypothesis or that there is a 0.000.. chance that our observed pattern is consistent with a random process </span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>MC<span class="ot">&lt;-</span> <span class="fu">moran.mc</span>(wus_gbl_merge<span class="sc">$</span>gain_2000_2020_ha, lw, <span class="at">nsim=</span><span class="dv">999</span>, <span class="at">alternative=</span><span class="st">&quot;greater&quot;</span>)</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a><span class="co"># View results (including p-value)</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>MC</span></code></pre></div>
<pre><code>## 
##  Monte-Carlo simulation of Moran I
## 
## data:  wus_gbl_merge$gain_2000_2020_ha 
## weights: lw  
## number of simulations + 1: 1000 
## 
## statistic = 0.40316, observed rank = 1000, p-value = 0.001
## alternative hypothesis: greater</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the Null distribution (note that this is a density plot instead of a histogram)</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(MC)</span></code></pre></div>
<p><img src="LMI_files/figure-html/unnamed-chunk-4-2.png" width="672" /></p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co">#The curve shows the distribution of Moran I values we could expect had the gain values been randomly distributed across the counties. Note that our observed statistic, 0.403156236, falls  to the right of the distribution suggesting that the gain values are clustered (a positive Moran’s I value suggests clustering whereas a negative Moran’s I value suggests dispersion).</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="co"># A visual used  assess how “typical” or “atypical” your pattern may be relative to a randomly distributed pattern is to plot the observed pattern alongside a few simulated patterns generated under the null hypothesis</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">131</span>)</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>wus_gbl_merge<span class="sc">$</span>rand1 <span class="ot">&lt;-</span> <span class="fu">sample</span>(wus_gbl_merge<span class="sc">$</span>gain_2000_2020_ha, <span class="fu">length</span>(wus_gbl_merge<span class="sc">$</span>gain_2000_2020_ha), <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>wus_gbl_merge<span class="sc">$</span>rand2 <span class="ot">&lt;-</span> <span class="fu">sample</span>(wus_gbl_merge<span class="sc">$</span>gain_2000_2020_ha, <span class="fu">length</span>(wus_gbl_merge<span class="sc">$</span>gain_2000_2020_ha), <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>wus_gbl_merge<span class="sc">$</span>rand3 <span class="ot">&lt;-</span> <span class="fu">sample</span>(wus_gbl_merge<span class="sc">$</span>gain_2000_2020_ha, <span class="fu">length</span>(wus_gbl_merge<span class="sc">$</span>gain_2000_2020_ha), <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting (the first one is real)</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(wus_gbl_merge) <span class="sc">+</span> <span class="fu">tm_fill</span>(<span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;gain_2000_2020_ha&quot;</span>, <span class="st">&quot;rand1&quot;</span>, <span class="st">&quot;rand2&quot;</span>, <span class="st">&quot;rand3&quot;</span>),</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>                      <span class="at">style=</span><span class="st">&quot;quantile&quot;</span>, <span class="at">n=</span><span class="dv">8</span>, <span class="at">palette=</span><span class="st">&quot;Greens&quot;</span>, <span class="at">legend.show =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>              <span class="fu">tm_facets</span>( <span class="at">nrow=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="LMI_files/figure-html/unnamed-chunk-4-3.png" width="672" /></p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate Local Moran&#39;s I</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>local_morans_i <span class="ot">&lt;-</span> <span class="fu">localmoran</span>(wus_gbl_merge<span class="sc">$</span>gain_2000_2020_ha, lw)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to a dataframe for easier manipulation</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>local_morans_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(local_morans_i)</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Add the Local Moran&#39;s I values and p-values to your spatial data frame</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>wus_gbl_merge<span class="sc">$</span>localI <span class="ot">&lt;-</span> local_morans_df[,<span class="dv">1</span>]</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>wus_gbl_merge<span class="sc">$</span>p_value <span class="ot">&lt;-</span> local_morans_df[,<span class="dv">5</span>]</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Classify into hot spots, cold spots based on Local Moran&#39;s I and p-values</span></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Here we consider hot spots as positive local I values with significant p-values (e.g., p &lt; 0.05)</span></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a><span class="co"># and cold spots as negative local I values with significant p-values.</span></span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>wus_gbl_merge<span class="sc">$</span>spot_type <span class="ot">&lt;-</span> <span class="fu">case_when</span>(</span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>  wus_gbl_merge<span class="sc">$</span>localI <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;</span> wus_gbl_merge<span class="sc">$</span>p_value <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">~</span> <span class="st">&quot;Hot Spot&quot;</span>,</span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>  wus_gbl_merge<span class="sc">$</span>localI <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">&amp;</span> wus_gbl_merge<span class="sc">$</span>p_value <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">~</span> <span class="st">&quot;Cold Spot&quot;</span>,</span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>  <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">&quot;Not Significant&quot;</span></span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize the hot and cold spots</span></span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(wus_gbl_merge) <span class="sc">+</span></span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">&quot;spot_type&quot;</span>, <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">&quot;Hot Spot&quot;</span> <span class="ot">=</span> <span class="st">&quot;red&quot;</span>, <span class="st">&quot;Cold Spot&quot;</span> <span class="ot">=</span> <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;Not Significant&quot;</span> <span class="ot">=</span> <span class="st">&quot;grey&quot;</span>), </span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="st">&quot;Spot Type&quot;</span>) <span class="sc">+</span></span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>() <span class="sc">+</span></span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">legend.title.size =</span> <span class="fl">0.7</span>, <span class="at">legend.text.size =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb38-26"><a href="#cb38-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_legend</span>(<span class="at">position =</span> <span class="fu">c</span>(<span class="st">&quot;right&quot;</span>, <span class="st">&quot;bottom&quot;</span>))</span></code></pre></div>
<p><img src="LMI_files/figure-html/unnamed-chunk-4-4.png" width="672" /></p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating table for data interpretation</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>hot_cold_zones1 <span class="ot">&lt;-</span> wus_gbl_merge <span class="sc">%&gt;%</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(spot_type <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Hot Spot&quot;</span>, <span class="st">&quot;Cold Spot&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(NAME, STATE_NAME, gain_2000_2020_ha, localI, p_value, spot_type) <span class="sc">%&gt;%</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_set_geometry</span>(<span class="cn">NULL</span>)  </span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">requireNamespace</span>(<span class="st">&quot;DT&quot;</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>  DT<span class="sc">::</span><span class="fu">datatable</span>(hot_cold_zones1, <span class="at">options =</span> <span class="fu">list</span>(<span class="at">pageLength =</span> <span class="dv">5</span>), </span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>                <span class="at">caption =</span> <span class="st">&quot;Counties and States in Hot and Cold Zones&quot;</span>)</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-845b819bf3daca08280f" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-845b819bf3daca08280f">{"x":{"filter":"none","vertical":false,"caption":"<caption>Counties and States in Hot and Cold Zones<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29"],["Klamath","Linn","Lewis","Sanders","Union","Benton","Jefferson","Thurston","Missoula","Powell","Douglas","Lake","Siskiyou","Deschutes","Ravalli","Pacific","Jefferson","Mineral","Lane","Lincoln","Harney","Lake","Bonner","Wahkiakum","Modoc","Boundary","Jackson","Coos","Crook"],["Oregon","Oregon","Washington","Montana","Oregon","Oregon","Washington","Washington","Montana","Montana","Oregon","Montana","California","Oregon","Montana","Washington","Oregon","Montana","Oregon","Montana","Oregon","Oregon","Idaho","Washington","California","Idaho","Oregon","Oregon","Oregon"],[72164,16981,23451,7080,12865,4753,4997,4550,17228,10760,25553,4756,12152,22288,6878,11729,2879,2736,26518,31008,9764,20151,6251,3211,10713,5544,6460,12174,8603],[17.3588120279058,1.6872999781844,1.87140085310189,0.425362200148774,1.13484086214546,-0.0116072184133258,0.0304682526536087,-0.060451360039169,1.63618337180176,0.786190188960664,6.47139249240063,-0.0137400498217698,1.32778222499238,6.1641548694051,0.267968186108607,1.4892201642402,-0.235414923753694,-0.312197527192039,8.71836969996822,3.49518962063052,0.587870956009971,5.67925761987038,0.160617534994213,-0.277744286969028,1.90852749610828,0.144791486214764,0.758333969507231,1.45029029964338,0.604374259328676],[4.44352654342677e-10,0.0141962295524003,0.0364356199824643,0.000388673433875633,0.0439171310148361,0.00507560598031587,0.0435286713516553,0.00104693398752559,0.00404742988370494,0.0203918146566624,2.50147943923605e-08,0.00251943497679611,0.000231881204255543,1.24510969843001e-11,0.0233669185163046,0.00797047224441525,0.0336754386148183,0.0329230017365851,6.99214402994906e-13,0.0477835468161016,0.0242731920180967,2.45276845171792e-09,0.0347631329706899,0.00582268594614819,1.49428458236249e-08,0.0152274915840654,6.40238134869536e-11,0.0477495449836682,0.0110339992589973],["Hot Spot","Hot Spot","Hot Spot","Hot Spot","Hot Spot","Cold Spot","Hot Spot","Cold Spot","Hot Spot","Hot Spot","Hot Spot","Cold Spot","Hot Spot","Hot Spot","Hot Spot","Hot Spot","Cold Spot","Cold Spot","Hot Spot","Hot Spot","Hot Spot","Hot Spot","Hot Spot","Cold Spot","Hot Spot","Hot Spot","Hot Spot","Hot Spot","Hot Spot"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>NAME<\/th>\n      <th>STATE_NAME<\/th>\n      <th>gain_2000_2020_ha<\/th>\n      <th>localI<\/th>\n      <th>p_value<\/th>\n      <th>spot_type<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"columnDefs":[{"className":"dt-right","targets":[3,4,5]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"NAME","targets":1},{"name":"STATE_NAME","targets":2},{"name":"gain_2000_2020_ha","targets":3},{"name":"localI","targets":4},{"name":"p_value","targets":5},{"name":"spot_type","targets":6}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="local-morans-i-for-tree-cover-loss" class="section level2"
number="0.3">
<h2><span class="header-section-number">0.3</span> Local Moran’s I for
Tree Cover Loss</h2>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Merging projected SF to GFW data frame</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>wus_loss_merge <span class="ot">&lt;-</span> wus_counties_sf_pro <span class="sc">%&gt;%</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(df_subset, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;STATE_NAME&quot;</span> <span class="ot">=</span> <span class="st">&quot;subnational1&quot;</span>, <span class="st">&quot;NAME&quot;</span> <span class="ot">=</span> <span class="st">&quot;subnational2&quot;</span>))</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Replacing NA&#39;s with zero</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>total_loss_by_county <span class="ot">&lt;-</span> wus_loss_merge <span class="sc">%&gt;%</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">starts_with</span>(<span class="st">&quot;tc_loss_ha_&quot;</span>), as.numeric, <span class="at">.names =</span> <span class="st">&quot;numeric_{.col}&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">loss_2000_2020_ha =</span> <span class="fu">sum</span>(<span class="fu">c_across</span>(<span class="fu">starts_with</span>(<span class="st">&quot;numeric_tc_loss_ha_&quot;</span>)), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">starts_with</span>(<span class="st">&quot;numeric_tc_loss_ha_&quot;</span>)) <span class="co"># Removing temporary numeric columns</span></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>nb1 <span class="ot">&lt;-</span> <span class="fu">poly2nb</span>(total_loss_by_county, <span class="at">queen=</span><span class="cn">TRUE</span>)</span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a>nb1[<span class="dv">1</span>]</span></code></pre></div>
<pre><code>## [[1]]
## [1]  93 215 219 233</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>lw1 <span class="ot">&lt;-</span> <span class="fu">nb2listw</span>(nb1, <span class="at">style=</span><span class="st">&quot;W&quot;</span>, <span class="at">zero.policy=</span><span class="cn">TRUE</span>)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>lw1<span class="sc">$</span>weights[<span class="dv">1</span>]</span></code></pre></div>
<pre><code>## [[1]]
## [1] 0.25 0.25 0.25 0.25</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>loss.lag <span class="ot">&lt;-</span> <span class="fu">lag.listw</span>(lw, total_loss_by_county<span class="sc">$</span>loss_2000_2020_ha)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>loss.lag</span></code></pre></div>
<pre><code>##   [1]  12362.50000   1680.00000 145606.14286  74178.57143  25640.00000  50345.33333  42110.16667
##   [8]  24747.75000  77129.16667  66405.00000  19338.76923  19208.80000   5943.16667   9909.75000
##  [15]  58351.42857   4369.71429  12498.75000 145056.00000  41615.25000   4749.20000  33604.16667
##  [22]   4824.00000   1004.80000  68601.00000 154077.50000  12829.77778  28860.50000  67681.62500
##  [29]  35598.50000  77927.00000      7.80000  91420.57143  20984.75000  12270.50000  25790.83333
##  [36]  18794.16667  27741.14286  41061.25000  25560.40000   3415.60000  42686.25000   1082.60000
##  [43]    865.00000   8137.66667 104821.75000  15526.28571  30264.50000  34848.40000  19172.85714
##  [50]      1.75000  77246.33333      0.00000   6298.57143   8676.66667 160335.40000  15108.50000
##  [57]  44164.25000  16697.00000  98715.50000  60872.50000    378.33333  30956.16667  58623.33333
##  [64]  87142.25000  55091.50000  63412.20000   1990.62500 118764.44444  83301.83333 105044.66667
##  [71]  11294.80000  55992.66667  39622.50000   4909.40000  13925.87500  26828.50000  14420.75000
##  [78]  34411.40000   4655.25000   6974.83333 106796.00000  82336.00000  40874.75000   2645.50000
##  [85]   2047.16667  43656.75000  17052.12500  44220.00000   7525.12500  68334.40000  53816.00000
##  [92]   4274.00000   4350.60000  33349.00000 124081.33333  61124.55556  29701.25000 135540.33333
##  [99] 145386.33333  72880.16667  22698.25000  13674.66667  18852.87500  24417.66667 143253.33333
## [106]  17257.50000  33698.20000  16682.00000    565.50000  49042.80000    943.20000  66085.42857
## [113]  25110.25000  19682.20000 105530.62500  36762.75000  66466.20000 101692.00000  11282.20000
## [120]   9678.40000  28634.16667   3337.00000   2844.33333  42190.00000  66384.00000 148424.00000
## [127]   1272.85714  28849.66667   1235.50000  21703.83333  66459.50000  24816.00000  87243.00000
## [134] 131091.33333 109179.66667  37849.14286  12700.00000   4545.75000  23687.80000  17844.80000
## [141]   7090.33333   5947.75000  21050.75000  21920.00000  38027.00000  19757.66667  55861.50000
## [148]  87885.33333   2330.12500 153840.00000   4172.33333 133927.80000  34012.20000  46049.66667
## [155] 131866.00000  96851.25000  59832.00000    873.00000  73623.44444 107033.33333  35331.42857
## [162]  26250.37500   4586.40000 112153.25000  39915.80000  87468.00000  36027.62500  53004.00000
## [169]   1194.22222  30155.57143  27230.00000    781.85714  13224.80000  42858.80000   8232.40000
## [176]  63680.57143  82538.60000  49651.14286  53996.77778   1072.66667  87502.25000  43925.83333
## [183]  17559.80000  40177.60000  58543.25000  61536.80000   1785.14286    362.83333 117486.66667
## [190]      2.00000   3071.25000  86172.71429    668.40000      2.00000    619.33333  27700.00000
## [197]  26489.12500   2397.00000  75178.33333  52193.00000  48523.50000  50574.00000   2284.00000
## [204] 104809.50000   1486.75000 195753.50000     11.66667  61310.75000    980.20000   3951.33333
## [211]    837.20000   3905.80000  39697.00000 208000.00000   3777.71429  18705.87500  83497.80000
## [218]   5579.00000  15761.20000   1594.75000   2821.33333   5583.14286    772.25000  60524.33333
## [225]  58483.71429  22421.33333  59823.83333   7184.83333   3756.00000   7299.40000  12768.33333
## [232]  37709.80000  14357.40000  15381.16667  20951.66667  47971.40000    269.16667      1.50000
## [239]  43219.42857  58113.80000   2021.00000  51399.40000   2278.00000  20582.75000   2922.50000
## [246]   3586.85714  37640.60000  22631.33333  13551.80000  20225.75000</code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(loss.lag <span class="sc">~</span> total_loss_by_county<span class="sc">$</span>loss_2000_2020_ha, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">asp=</span><span class="dv">1</span>)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>M1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(loss.lag <span class="sc">~</span> total_loss_by_county<span class="sc">$</span>loss_2000_2020_ha)</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(M1, <span class="at">col=</span><span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="LMI_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(M1)[<span class="dv">2</span>]</span></code></pre></div>
<pre><code>## total_loss_by_county$loss_2000_2020_ha 
##                               0.428762</code></pre>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>I <span class="ot">&lt;-</span> <span class="fu">moran</span>(total_loss_by_county<span class="sc">$</span>loss_2000_2020_ha, lw1, <span class="fu">length</span>(nb), <span class="fu">Szero</span>(lw1))[<span class="dv">1</span>]</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>I</span></code></pre></div>
<pre><code>## $I
## [1] 0.4287462</code></pre>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">moran.test</span>(total_loss_by_county<span class="sc">$</span>loss_2000_2020_ha,lw1, <span class="at">alternative=</span><span class="st">&quot;greater&quot;</span>)</span></code></pre></div>
<pre><code>## 
##  Moran I test under randomisation
## 
## data:  total_loss_by_county$loss_2000_2020_ha  
## weights: lw1  n reduced by no-neighbour observations
##   
## 
## Moran I statistic standard deviate = 10.992, p-value &lt; 2.2e-16
## alternative hypothesis: greater
## sample estimates:
## Moran I statistic       Expectation          Variance 
##       0.427031245      -0.004032258       0.001537987</code></pre>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="do">####There is less than a 6% likelihood that the observed pattern could be the result of random chance</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="co">#p-value of 2.2e-16 suggesting that there would be a an extremely low chance of being wrong in rejecting the null hypothesis or that there is a 0.000.. chance that our observed pattern is consistent with a random process </span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>MC<span class="ot">&lt;-</span> <span class="fu">moran.mc</span>(total_loss_by_county<span class="sc">$</span>loss_2000_2020_ha, lw1, <span class="at">nsim=</span><span class="dv">999</span>, <span class="at">alternative=</span><span class="st">&quot;greater&quot;</span>)</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a><span class="co"># View results (including p-value)</span></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>MC</span></code></pre></div>
<pre><code>## 
##  Monte-Carlo simulation of Moran I
## 
## data:  total_loss_by_county$loss_2000_2020_ha 
## weights: lw1  
## number of simulations + 1: 1000 
## 
## statistic = 0.42703, observed rank = 1000, p-value = 0.001
## alternative hypothesis: greater</code></pre>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the Null distribution (note that this is a density plot instead of a histogram)</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(MC)</span></code></pre></div>
<p><img src="LMI_files/figure-html/unnamed-chunk-5-2.png" width="672" /></p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co">#The curve shows the distribution of Moran I values we could expect had the forest loss been randomly distributed across the counties. Note that our observed statistic, 0.42703, falls  to the right of the distribution suggesting that the loss values are clustered (a positive Moran’s I value suggests clustering whereas a negative Moran’s I value suggests dispersion).</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">131</span>)</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>total_loss_by_county<span class="sc">$</span>rand1 <span class="ot">&lt;-</span> <span class="fu">sample</span>(total_loss_by_county<span class="sc">$</span>loss_2000_2020_ha, <span class="fu">length</span>(total_loss_by_county<span class="sc">$</span>loss_2000_2020_ha), <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>total_loss_by_county<span class="sc">$</span>rand2 <span class="ot">&lt;-</span> <span class="fu">sample</span>(total_loss_by_county<span class="sc">$</span>loss_2000_2020_ha, <span class="fu">length</span>(total_loss_by_county<span class="sc">$</span>loss_2000_2020_ha), <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>total_loss_by_county<span class="sc">$</span>rand3 <span class="ot">&lt;-</span> <span class="fu">sample</span>(total_loss_by_county<span class="sc">$</span>loss_2000_2020_ha, <span class="fu">length</span>(total_loss_by_county<span class="sc">$</span>loss_2000_2020_ha), <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting (first map is real data)</span></span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(total_loss_by_county) <span class="sc">+</span> <span class="fu">tm_fill</span>(<span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;loss_2000_2020_ha&quot;</span>, <span class="st">&quot;rand1&quot;</span>, <span class="st">&quot;rand2&quot;</span>, <span class="st">&quot;rand3&quot;</span>),</span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>                      <span class="at">style=</span><span class="st">&quot;quantile&quot;</span>, <span class="at">n=</span><span class="dv">8</span>, <span class="at">palette=</span><span class="st">&quot;Reds&quot;</span>, <span class="at">legend.show =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>              <span class="fu">tm_facets</span>( <span class="at">nrow=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="LMI_files/figure-html/unnamed-chunk-5-3.png" width="672" /></p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate Local Moran&#39;s I for tree cover loss</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>local_morans_i_loss <span class="ot">&lt;-</span> <span class="fu">localmoran</span>(total_loss_by_county<span class="sc">$</span>loss_2000_2020_ha, lw1)</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Incorporate Local Moran&#39;s I stats into the total_loss_by_county dataframe</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>total_loss_by_county<span class="sc">$</span>localI <span class="ot">&lt;-</span> local_morans_i_loss[,<span class="dv">1</span>]  <span class="co"># Local Moran&#39;s I value</span></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>total_loss_by_county<span class="sc">$</span>p.value <span class="ot">&lt;-</span> local_morans_i_loss[,<span class="dv">5</span>]  <span class="co"># P-value</span></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Define hot (High-High) and cold (Low-Low) spots based on Local Moran&#39;s I and p-value</span></span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>total_loss_by_county<span class="sc">$</span>hot_cold_zone <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(total_loss_by_county<span class="sc">$</span>localI <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;</span> total_loss_by_county<span class="sc">$</span>p.value <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="st">&quot;Hot Spot&quot;</span>,</span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>                                             <span class="fu">ifelse</span>(total_loss_by_county<span class="sc">$</span>localI <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">&amp;</span> total_loss_by_county<span class="sc">$</span>p.value <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="st">&quot;Cold Spot&quot;</span>, <span class="st">&quot;Not Significant&quot;</span>))</span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize Hot and Cold Zones with tmap</span></span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(total_loss_by_county) <span class="sc">+</span></span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">&quot;hot_cold_zone&quot;</span>,</span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a>          <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">&quot;Hot Spot&quot;</span> <span class="ot">=</span> <span class="st">&quot;red&quot;</span>, <span class="st">&quot;Cold Spot&quot;</span> <span class="ot">=</span> <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;Not Significant&quot;</span> <span class="ot">=</span> <span class="st">&quot;grey&quot;</span>),</span>
<span id="cb57-16"><a href="#cb57-16" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="st">&quot;Tree Cover Loss Hot and Cold Zones&quot;</span>) <span class="sc">+</span></span>
<span id="cb57-17"><a href="#cb57-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>() <span class="sc">+</span></span>
<span id="cb57-18"><a href="#cb57-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_legend</span>(<span class="at">position =</span> <span class="fu">c</span>(<span class="st">&quot;right&quot;</span>, <span class="st">&quot;bottom&quot;</span>)) <span class="sc">+</span></span>
<span id="cb57-19"><a href="#cb57-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">frame =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="LMI_files/figure-html/unnamed-chunk-5-4.png" width="672" /></p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating table for data interpretation</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>hot_cold_zones <span class="ot">&lt;-</span> total_loss_by_county <span class="sc">%&gt;%</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(hot_cold_zone <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Hot Spot&quot;</span>, <span class="st">&quot;Cold Spot&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(NAME, STATE_NAME, loss_2000_2020_ha, localI, p.value, hot_cold_zone) <span class="sc">%&gt;%</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_set_geometry</span>(<span class="cn">NULL</span>)  </span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">requireNamespace</span>(<span class="st">&quot;DT&quot;</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>  DT<span class="sc">::</span><span class="fu">datatable</span>(hot_cold_zones, <span class="at">options =</span> <span class="fu">list</span>(<span class="at">pageLength =</span> <span class="dv">5</span>), </span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>                <span class="at">caption =</span> <span class="st">&quot;Detailed Counties and States in Hot and Cold Zones&quot;</span>)</span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-0e57e63990d46cd86e44" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-0e57e63990d46cd86e44">{"x":{"filter":"none","vertical":false,"caption":"<caption>Detailed Counties and States in Hot and Cold Zones<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37"],["Klamath","Del Norte","Humboldt","Nez Perce","Sanders","Benton","Josephine","Valley","Missoula","Powell","Adams","Lemhi","Douglas","Tehama","Shasta","Lake","Siskiyou","Douglas","Lewis","Deschutes","Ferry","Ravalli","Whatcom","Trinity","Curry","Mineral","Idaho","Lane","Lincoln","Mendocino","Nye","Modoc","Clearwater","Skagit","Jackson","Coos","Lassen"],["Oregon","California","California","Idaho","Montana","Oregon","Oregon","Idaho","Montana","Montana","Idaho","Idaho","Oregon","California","California","Montana","California","Washington","Idaho","Oregon","Washington","Montana","Washington","California","Oregon","Montana","Idaho","Oregon","Montana","California","Nevada","California","Idaho","Washington","Oregon","Oregon","California"],[120680,36623,83878,9346,111249,29197,99760,191830,87945,90310,24864,104907,290994,72302,167361,24526,271580,1919,4991,44007,106028,81272,29736,233589,125006,34932,335182,221481,103073,74518,628,24880,100744,38459,77474,100087,55042],[3.1609060414075,0.0229841430627075,1.92523472526192,-0.380640406136119,1.42019727594637,-0.159551421484809,2.69981415298554,3.32827501070219,1.46407895079997,0.874822170474134,-0.261957032990122,1.66132233836071,7.64926955523167,1.23053851182279,4.89365046027201,-0.419276883373294,5.57846333256869,-0.762578128742647,-1.18747125589832,0.139661209034074,2.26778292922157,1.128207591153,-0.251566570934482,6.58984028506221,2.90588484488257,-0.0222199380429394,3.83330628234215,4.48704190299769,1.73947864076134,0.675075608813281,0.419419299346678,-0.308721088290389,1.10620780646427,0.0575274096366622,2.25634235378816,3.75399206202109,0.307954277942591],[5.02946498007612e-08,5.30687981776855e-05,1.13376666414284e-05,0.0390378977329154,0.00579218510372847,0.0107868614045607,2.13289293573887e-07,0.00332605457446974,3.02952575992894e-06,0.0300066669466243,0.00166154887838633,0.000436007675394919,2.09464651075843e-05,5.43400549508095e-06,3.98807575565578e-07,0.000594544382821064,0.000107016763403008,0.0150435777522757,0.000319127895028686,0.011428293158138,0.00217666365310343,0.000813693464217712,0.00210552303102914,2.52213807865661e-05,0.000336461689919973,0.0241391614320445,0.0199323668086021,0.000805109711296232,0.00449848451369337,0.0185226119619558,0.0494299352606182,0.000205629371404029,0.0126022367988289,0.0107604626109994,2.96262618101382e-09,6.5296101565868e-06,0.0481975109310149],["Hot Spot","Hot Spot","Hot Spot","Cold Spot","Hot Spot","Cold Spot","Hot Spot","Hot Spot","Hot Spot","Hot Spot","Cold Spot","Hot Spot","Hot Spot","Hot Spot","Hot Spot","Cold Spot","Hot Spot","Cold Spot","Cold Spot","Hot Spot","Hot Spot","Hot Spot","Cold Spot","Hot Spot","Hot Spot","Cold Spot","Hot Spot","Hot Spot","Hot Spot","Hot Spot","Hot Spot","Cold Spot","Hot Spot","Hot Spot","Hot Spot","Hot Spot","Hot Spot"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>NAME<\/th>\n      <th>STATE_NAME<\/th>\n      <th>loss_2000_2020_ha<\/th>\n      <th>localI<\/th>\n      <th>p.value<\/th>\n      <th>hot_cold_zone<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"columnDefs":[{"className":"dt-right","targets":[3,4,5]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"NAME","targets":1},{"name":"STATE_NAME","targets":2},{"name":"loss_2000_2020_ha","targets":3},{"name":"localI","targets":4},{"name":"p.value","targets":5},{"name":"hot_cold_zone","targets":6}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="discussion" class="section level2" number="0.4">
<h2><span class="header-section-number">0.4</span> Discussion:</h2>
<div
id="the-morans-i-analysis-summary-for-the-20-year-tree-cover-loss-shows-a-morans-i-statistic-of-0.427031245.-this-value-is-significantly-different-from-the-expectation-close-to-0-in-the-case-of-random-distribution-as-evidenced-by-the-p-value-being-less-than-2.2e-16-indicating-a-strong-spatial-autocorrelation.-this-result-suggests-that-there-is-a-non-random-pattern-to-the-tree-cover-loss-over-the-area-studied-with-a-tendency-towards-clustering-of-similar-values-either-high-or-low-loss-in-space."
class="section level4" number="0.4.0.1">
<h4><span class="header-section-number">0.4.0.1</span> The Moran’s I
analysis summary for the 20-year tree cover loss shows a Moran’s I
statistic of 0.427031245. This value is significantly different from the
expectation (close to 0 in the case of random distribution), as
evidenced by the p-value being less than 2.2e-16, indicating a strong
spatial autocorrelation. This result suggests that there is a non-random
pattern to the tree cover loss over the area studied, with a tendency
towards clustering of similar values (either high or low loss) in
space.</h4>
</div>
<div
id="the-monte-carlo-simulation-of-morans-i-reinforces-this-finding-with-a-p-value-of-0.001-based-on-1000-simulations.-this-low-p-value-further-confirms-the-unlikelihood-that-the-observed-spatial-pattern-is-due-to-random-chance.-thus-the-tree-cover-loss-is-not-randomly-distributed-but-rather-exhibits-significant-spatial-clustering-which-could-be-due-to-various-ecological-geographical-or-human-induced-factors."
class="section level4" number="0.4.0.2">
<h4><span class="header-section-number">0.4.0.2</span> The Monte-Carlo
simulation of Moran’s I reinforces this finding with a p-value of 0.001,
based on 1000 simulations. This low p-value further confirms the
unlikelihood that the observed spatial pattern is due to random chance.
Thus, the tree cover loss is not randomly distributed but rather
exhibits significant spatial clustering, which could be due to various
ecological, geographical, or human-induced factors.</h4>
</div>
<div
id="the-summary-for-the-morans-i-analysis-for-tree-cover-gain-shows-that-the-morans-i-statistic-is-0.403156236-which-is-significantly-greater-than-the-expected-value-close-to-0-if-the-spatial-distribution-was-random.-the-p-value-is-less-than-2.2e-16-indicating-strong-statistical-evidence-against-the-null-hypothesis-of-randomness."
class="section level4" number="0.4.0.3">
<h4><span class="header-section-number">0.4.0.3</span> The summary for
the Moran’s I analysis for tree cover gain shows that the Moran’s I
statistic is 0.403156236, which is significantly greater than the
expected value (close to 0 if the spatial distribution was random). The
p-value is less than 2.2e-16, indicating strong statistical evidence
against the null hypothesis of randomness.</h4>
</div>
<div
id="the-monte-carlo-simulation-with-1000-simulations-supports-this-finding-yielding-a-p-value-of-0.001.-this-confirms-that-the-observed-spatial-pattern-clustering-of-similar-values-in-tree-cover-gain-is-highly-unlikely-to-be-due-to-random-chance-suggesting-a-significant-spatial-autocorrelation.-this-means-that-areas-with-high-tree-cover-gain-are-likely-to-be-geographically-close-to-other-areas-of-high-gain-and-similarly-for-low-gain-areas."
class="section level4" number="0.4.0.4">
<h4><span class="header-section-number">0.4.0.4</span> The Monte-Carlo
simulation, with 1000 simulations, supports this finding, yielding a
p-value of 0.001. This confirms that the observed spatial pattern
(clustering of similar values) in tree cover gain is highly unlikely to
be due to random chance, suggesting a significant spatial
autocorrelation. This means that areas with high tree cover gain are
likely to be geographically close to other areas of high gain, and
similarly for low gain areas.</h4>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
